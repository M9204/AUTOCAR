<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>LED Control via HiveMQ Cloud</title>
  <script src="https://unpkg.com/paho-mqtt/mqttws31.min.js"></script>
</head>
<body style="font-family: Arial; text-align: center; margin-top: 50px;">
  <h2>Arduino LED Control</h2>

  <label>Username: <input type="text" id="username"></label><br><br>
  <label>Password: <input type="password" id="password"></label><br><br>

  <button onclick="connect()">Connect</button>
  <hr>
  <button onclick="sendCommand('ON')">LED ON</button>
  <button onclick="sendCommand('OFF')">LED OFF</button>
  <button onclick="sendCommand('TOGGLE')">TOGGLE</button>

  <script>
    const BROKER_URL = "ws://test.mosquitto.org:8080/mqtt";
    const TOPIC = "device/33234323/led";

    let client;

    function connect() {
      const username = document.getElementById("username").value;
      const password = document.getElementById("password").value;
      const clientId = "webClient-" + Math.random().toString(16).substr(2, 8);

      client = new Paho.MQTT.Client(BROKER_URL, clientId);

      client.connect({
        useSSL: true,
        userName: username,
        password: password,
        onSuccess: () => alert("Connected to HiveMQ Cloud via WebSocket!"),
        onFailure: (err) => alert("Connection failed: " + JSON.stringify(err))
      });
    }

    function sendCommand(cmd) {
      if (!client || !client.isConnected()) {
        alert("Not connected!");
        return;
      }
      const message = new Paho.MQTT.Message(cmd);
      message.destinationName = TOPIC;
      client.send(message);
      console.log("Sent:", cmd);
    }
  </script>
</body>
</html>
